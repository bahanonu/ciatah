<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Biafra Ahanonu">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
<title>Manual cell sorting</title>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link href="../css/extra.css" rel="stylesheet" />
  <link href="../css/pygments.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Manual cell sorting";
    var mkdocs_page_input_path = "help_manual_cell_sorting.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> CIAtah</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">End-to-end</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../all_docs/">One-page readme</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../all_docs/">One-page readme (auto)</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Setup</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../install/">Quick Start</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../install_alt/">Install</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../example_data/">Example data</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../dependencies/">Dependencies</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Repository</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../data/">Data formats</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../notes/">Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../organization/">Organization</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Processing imaging data</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_overview/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_all/">One-page step-by-step</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed/">One-page step-by-step (auto)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_downsample_raw/">1| Downsample raw movies</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_preprocess_check/">2| Check pre-process settings</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_preprocess/">3| <u><strong>Processing imaging movies</strong></u></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_modify_movies/">4| Movie clean-up</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_signal_extraction/">5| <u><strong>Cell extraction</strong></u></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_signal_extraction_load/">6| Loading cell extraction outputs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_signal_extraction_validation/">7| <u><strong>Cell extraction validation</strong></u></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_signal_sorting_manual/">8| <u><strong>Manual cell sorting</strong></u></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_signal_region_analysis/">9| Region-specific analysis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_cross_session/">10| <u><strong>Cross-session alignment</strong></u></a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Spinal cord motion correction</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_detailed_spinal/">Spinal cord motion correction</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Animal tracking</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../pipeline_animal_tracking/">Animal tracking (ImageJ+MATLAB)</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../api_example_pipeline/">Custom pipelines</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../api_ciapkg/">ciapkg</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Help</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../help_issues/">Issues and fixes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../blank/"><div class='subsection1'>Data</div></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_inscopix/">Inscopix</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_nwb/">Neurodata Without Borders</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../blank/"><div class='subsection1'>Interface</div></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_contrast/">Movie display and noise</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../blank/"><div class='subsection1'>Analysis</div></a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_analysis_methods/">Analysis methods</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_large_movie_analysis/">Large movie analysis</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_stripe_removal/">Stripe removal</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_snr/">Improving signal-to-noise</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_spatial_filtering/">Spatial filtering</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_temporal_downsampling/">Temporal downsampling</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_motion_correction/">Motion correction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_cell_extraction/">Cell extraction</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Manual cell sorting</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#signalsorter-use-with-large-or-remote-server-imaging-movies">signalSorter use with large or remote server imaging movies</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#interface">Interface</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#best-practices">Best practices</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#neighboring-cells">Neighboring cells</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#common-issues">Common issues</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_cross_session_alignment/">Cross-session alignemnt</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../help_animal_tracking/">Animal tracking</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Misc</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../acknowledgments/">Acknowledgments</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../references/">Cite</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../questions/">Questions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../license/">License</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">CIAtah</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Help &raquo;</li>
        
      
    
    <li>Manual cell sorting</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="manual-cell-sorting-of-cell-extraction-outputs">Manual cell sorting of cell extraction outputs<a class="headerlink" href="#manual-cell-sorting-of-cell-extraction-outputs" title="Permanent link">&para;</a></h1>
<p>This page will go over best practices and common issues seen when sorting cells from PCA-ICA. Advice can also apply to other cell sorting algorithms (CNMF, etc.).</p>
<p>As a general note, it is a bad idea to bias users by using heuristics or computational models to pre-select or guess whether a cell extraction output is a cell or non-cell. This will skew results toward whatever the heuristics or model are looking for rather than reveal the true preferences of the user.</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Usage instructions below for <code>signalSorter.m</code>:</p>
<p><strong>Main inputs</strong></p>
<ul>
<li><code>inputImages</code> - [x y N] matrix where N = number of images, x/y are dimensions.</li>
<li><code>inputSignals</code> - [N frames] <em>double</em> matrix where N = number of signals (traces).</li>
<li><code>inputMovie</code> - [x y frames] matrix</li>
</ul>
<p><strong>Main outputs</strong></p>
<ul>
<li><code>choices</code> - [N 1] vector of 1 = cell, 0 = not a cell</li>
<li><code>inputImagesSorted</code> - [x y N] filtered by `choices'</li>
<li><code>inputSignalsSorted</code> - [N frames] filtered by <code>choice</code></li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="lineno" data-linenos=" 1 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">inputMovie</span> <span class="p">=</span> <span class="n">inputMovie</span><span class="p">;</span> <span class="c">% movie associated with traces</span>
<span class="lineno" data-linenos=" 2 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">valid</span> <span class="p">=</span> <span class="s">&#39;neutralStart&#39;</span><span class="p">;</span> <span class="c">% all choices start out gray or neutral to not bias user</span>
<span class="lineno" data-linenos=" 3 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">cropSizeLength</span> <span class="p">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c">% region, in px, around a signal source for transient cut movies (subplot 2)</span>
<span class="lineno" data-linenos=" 4 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">cropSize</span> <span class="p">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c">% see above</span>
<span class="lineno" data-linenos=" 5 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">medianFilterTrace</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% whether to subtract a rolling median from trace</span>
<span class="lineno" data-linenos=" 6 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">subtractMean</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% whether to subtract the trace mean</span>
<span class="lineno" data-linenos=" 7 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">movieMin</span> <span class="p">=</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">;</span> <span class="c">% helps set contrast for subplot 2, preset movie min here or it is calculated</span>
<span class="lineno" data-linenos=" 8 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">movieMax</span> <span class="p">=</span> <span class="mf">0.05</span><span class="p">;</span> <span class="c">% helps set contrast for subplot 2, preset movie max here or it is calculated</span>
<span class="lineno" data-linenos=" 9 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">backgroundGood</span> <span class="p">=</span> <span class="p">[</span><span class="mi">208</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span><span class="mi">180</span><span class="p">]</span><span class="o">/</span><span class="mi">255</span><span class="p">;</span>
<span class="lineno" data-linenos="10 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">backgroundBad</span> <span class="p">=</span> <span class="p">[</span><span class="mi">244</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">166</span><span class="p">]</span><span class="o">/</span><span class="mi">255</span><span class="p">;</span>
<span class="lineno" data-linenos="11 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">backgroundNeutral</span> <span class="p">=</span> <span class="nb">repmat</span><span class="p">(</span><span class="mi">230</span><span class="p">,[</span><span class="mi">1</span> <span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="mi">255</span><span class="p">;</span>
<span class="lineno" data-linenos="12 "></span><span class="p">[</span><span class="n">inputImagesSorted</span><span class="p">,</span> <span class="n">inputSignalsSorted</span><span class="p">,</span> <span class="n">choices</span><span class="p">]</span> <span class="p">=</span> <span class="n">signalSorter</span><span class="p">(</span><span class="n">inputImages</span><span class="p">,</span> <span class="n">inputSignals</span><span class="p">,</span> <span class="s">&#39;options&#39;</span><span class="p">,</span><span class="n">iopts</span><span class="p">);</span>
</code></pre></div>
<h3 id="signalsorter-use-with-large-or-remote-server-imaging-movies"><code>signalSorter</code> use with large or remote server imaging movies<a class="headerlink" href="#signalsorter-use-with-large-or-remote-server-imaging-movies" title="Permanent link">&para;</a></h3>
<p>For imaging movies that are too large to fit into RAM or that are stored on remote systems, run the below commands. Remember to change <code>inputImages</code>, <code>inputSignals</code>, <code>iopts.inputMovie</code>, and <code>iopts.inputDatasetName</code> to values appropriate for your data). <strong>Note: only HDF5 files are supported with this feature due to use of spatial chunking.</strong></p>
<div class="codehilite"><pre><span></span><code><span class="lineno" data-linenos=" 1 "></span><span class="c">% CRITICAL USER PARAMETERS</span>
<span class="lineno" data-linenos=" 2 "></span><span class="c">% Input images and signals, change from PCA-ICA to whatever is appropriate for input from user&#39;s cell extraction algorithm.</span>
<span class="lineno" data-linenos=" 3 "></span><span class="n">inputImages</span> <span class="p">=</span> <span class="n">pcaicaAnalysisOutput</span><span class="p">.</span><span class="n">IcaFilters</span><span class="p">;</span> <span class="c">% cell array of [x y nSignals] matrices containing each set of images corresponding to inputSignals objects.</span>
<span class="lineno" data-linenos=" 4 "></span><span class="n">inputSignals</span> <span class="p">=</span> <span class="n">pcaicaAnalysisOutput</span><span class="p">.</span><span class="n">IcaTraces</span><span class="p">;</span> <span class="c">% cell array of [nSignals frames] matrices containing each set of inputImages signals.</span>
<span class="lineno" data-linenos=" 5 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">inputMovie</span> <span class="p">=</span> <span class="p">[</span><span class="s">&#39;pathToImagingSessionFolder&#39;</span> <span class="n">filesep</span> <span class="s">&#39;MOVIE_FILE_NAME.h5&#39;</span><span class="p">];</span>
<span class="lineno" data-linenos=" 6 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">inputDatasetName</span> <span class="p">=</span> <span class="s">&#39;/1&#39;</span><span class="p">;</span> <span class="c">% HDF5 dataset name</span>
<span class="lineno" data-linenos=" 7 "></span>
<span class="lineno" data-linenos=" 8 "></span><span class="c">% MAIN USER parameters: change these as needed</span>
<span class="lineno" data-linenos=" 9 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">preComputeImageCutMovies</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% Binary: 0 recommended. 1 = pre-compute movies aligned to signal transients, 0 = do not pre-compute.</span>
<span class="lineno" data-linenos="10 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">readMovieChunks</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c">% Binary: 1 recommended. 1 = read movie from HDD, 0 = load entire movie into RAM.</span>
<span class="lineno" data-linenos="11 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">showImageCorrWithCharInputMovie</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% Binary: 0 recommended. 1 = show the image correlation value when input path to options.inputMovie (e.g. when not loading entire movie into RAM).</span>
<span class="lineno" data-linenos="12 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">maxSignalsToShow</span> <span class="p">=</span> <span class="mi">9</span><span class="p">;</span> <span class="c">%Int: max movie cut images to show</span>
<span class="lineno" data-linenos="13 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">nSignalsLoadAsync</span> <span class="p">=</span> <span class="mi">30</span><span class="p">;</span> <span class="c">% Int: number of signals ahead of current to asynchronously load imageCutMovies, might make the first couple signal selections slow while loading takes place</span>
<span class="lineno" data-linenos="14 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">threshold</span> <span class="p">=</span> <span class="mf">0.3</span><span class="p">;</span> <span class="c">% threshold for thresholding images</span>
<span class="lineno" data-linenos="15 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">thresholdOutline</span> <span class="p">=</span> <span class="mf">0.3</span><span class="p">;</span> <span class="c">% threshold for thresholding images</span>
<span class="lineno" data-linenos="16 "></span>
<span class="lineno" data-linenos="17 "></span><span class="c">% OPTIONAL</span>
<span class="lineno" data-linenos="18 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">valid</span> <span class="p">=</span> <span class="s">&#39;neutralStart&#39;</span><span class="p">;</span> <span class="c">% all choices start out gray or neutral to not bias user</span>
<span class="lineno" data-linenos="19 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">cropSizeLength</span> <span class="p">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c">% region, in px, around a signal source for transient cut movies (subplot 2)</span>
<span class="lineno" data-linenos="20 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">cropSize</span> <span class="p">=</span> <span class="mi">20</span><span class="p">;</span> <span class="c">% see above</span>
<span class="lineno" data-linenos="21 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">medianFilterTrace</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% whether to subtract a rolling median from trace</span>
<span class="lineno" data-linenos="22 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">subtractMean</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% whether to subtract the trace mean</span>
<span class="lineno" data-linenos="23 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">movieMin</span> <span class="p">=</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">;</span> <span class="c">% helps set contrast for subplot 2, preset movie min here or it is calculated</span>
<span class="lineno" data-linenos="24 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">movieMax</span> <span class="p">=</span> <span class="mf">0.05</span><span class="p">;</span> <span class="c">% helps set contrast for subplot 2, preset movie max here or it is calculated</span>
<span class="lineno" data-linenos="25 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">backgroundGood</span> <span class="p">=</span> <span class="p">[</span><span class="mi">208</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span><span class="mi">180</span><span class="p">]</span><span class="o">/</span><span class="mi">255</span><span class="p">;</span>
<span class="lineno" data-linenos="26 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">backgroundBad</span> <span class="p">=</span> <span class="p">[</span><span class="mi">244</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">166</span><span class="p">]</span><span class="o">/</span><span class="mi">255</span><span class="p">;</span>
<span class="lineno" data-linenos="27 "></span><span class="n">iopts</span><span class="p">.</span><span class="n">backgroundNeutral</span> <span class="p">=</span> <span class="nb">repmat</span><span class="p">(</span><span class="mi">230</span><span class="p">,[</span><span class="mi">1</span> <span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="mi">255</span><span class="p">;</span>
<span class="lineno" data-linenos="28 "></span>
<span class="lineno" data-linenos="29 "></span><span class="p">[</span><span class="o">~</span><span class="p">,</span> <span class="o">~</span><span class="p">,</span> <span class="n">choices</span><span class="p">]</span> <span class="p">=</span> <span class="n">signalSorter</span><span class="p">(</span><span class="n">inputImages</span><span class="p">,</span> <span class="n">inputSignals</span><span class="p">,</span> <span class="s">&#39;options&#39;</span><span class="p">,</span><span class="n">iopts</span><span class="p">);</span>
</code></pre></div>
<h2 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h2>
<p><a href="https://user-images.githubusercontent.com/5241605/47396409-68da7b00-d6df-11e8-8c91-e85c3af356b5.png" target="_blank"><img src="https://user-images.githubusercontent.com/5241605/47396409-68da7b00-d6df-11e8-8c91-e85c3af356b5.png" alt="drawing" width="900" height="auto" /></a></p>
<p>GUI also contains a shortcut menu that users can access by right-clicking or selecting the top-left menu.</p>
<p><a href="https://user-images.githubusercontent.com/5241605/95838435-9ec30080-0cf6-11eb-981d-fc8b5d46de7b.png" target="_blank"><img src="https://user-images.githubusercontent.com/5241605/95838435-9ec30080-0cf6-11eb-981d-fc8b5d46de7b.png" alt="drawing" width="900" height="auto" /></a></p>
<p><strong>Example good cell extraction output</strong></p>
<p><a href="https://user-images.githubusercontent.com/5241605/58501425-3db67f00-8139-11e9-9c16-c7efc8a74144.gif" target="_blank"><img src="https://user-images.githubusercontent.com/5241605/58501425-3db67f00-8139-11e9-9c16-c7efc8a74144.gif" alt="drawing" width="600" height="auto"/></a></p>
<p><strong>Example bad cell extraction output</strong></p>
<p><a href="https://user-images.githubusercontent.com/5241605/58501420-3c855200-8139-11e9-8d1a-faea051ce2ea.gif" target="_blank"><img src="https://user-images.githubusercontent.com/5241605/58501420-3c855200-8139-11e9-8d1a-faea051ce2ea.gif" alt="drawing" width="600" height="auto"/></a></p>
<!-- ![2016_01_20_p460_m19_lineartrack01_s_bad_cellmax_517_1_32](https://user-images.githubusercontent.com/5241605/51698178-6a595f00-1fbe-11e9-940f-5dbcb08d4018.gif) -->

<p><strong>Jump to arbitrary cells</strong>
- Click the cell map window or press <code>V</code> and a orange cross hair will appear, this will take the user to the clicked upon cell.
<img alt="image" src="https://user-images.githubusercontent.com/5241605/68536470-1549c800-0308-11ea-84fa-be12deadb329.png" />
- Or select the full cellmap, will obtain the same result.
<img alt="image" src="https://user-images.githubusercontent.com/5241605/68536494-9ef99580-0308-11ea-9040-618d6d836440.png" />
- This cell can be viewed like normal.
<img alt="image" src="https://user-images.githubusercontent.com/5241605/68536471-21358a00-0308-11ea-804b-b831d236cb4d.png" />
- Users can then press <code>Y</code> to take them back to the last sorted cell (here #2). This function works even with the <code>G</code> go to new signal via index number command.
<img alt="image" src="https://user-images.githubusercontent.com/5241605/68536472-2c88b580-0308-11ea-811d-f40ad5ddf94e.png" /></p>
<p><strong>Press "t" to bring up interface to compare neighboring cells</strong>
<img alt="image" src="https://user-images.githubusercontent.com/5241605/58516068-9d258680-815b-11e9-95b5-683d7f9b3495.png" /></p>
<ul>
<li>Users can zoom in on the traces to get a better sense of correlation between activity traces.
<img alt="image" src="https://user-images.githubusercontent.com/5241605/58516133-d9f17d80-815b-11e9-8faa-50216cb0f9c2.png" /></li>
</ul>
<p><strong>Press "r" to bring up different views of trace</strong>
- ROI trace included in instances where the entire movie is already loaded into RAM.
<img alt="image" src="https://user-images.githubusercontent.com/5241605/58517092-0a86e680-815f-11e9-966e-4a505336afb6.png" /></p>
<p><img alt="image" src="https://user-images.githubusercontent.com/5241605/58517156-4cb02800-815f-11e9-80fb-859d55703058.png" /></p>
<p><strong>Press "c" to bring up the whole movie cut to extraction output activity trace events</strong></p>
<p><img alt="ezgif-4-5a699a41b244_v2" src="https://user-images.githubusercontent.com/5241605/58517956-3192e780-8162-11e9-8946-f68fb1b25eab.gif" /></p>
<p><img alt="image" src="https://user-images.githubusercontent.com/5241605/58517239-93058700-815f-11e9-9374-4ea0f2252044.png" /></p>
<h2 id="best-practices">Best practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<ul>
<li>Always sort the cells with the trace, filter, and either images or video cut to transients in the movie.</li>
<li>This gets around two types of cells: those with irregular firing patterns that might be thrown out (see below) or those whose filter and traces look good, but are either fragments of a high SNR cell (see <strong>Common issues</strong>) or not actually a cell (e.g. a particulate in the field of view that has transient-like movement).</li>
<li>Sometimes two or more cell extraction outputs are for the same cell. In these suspected cases, press <code>t</code> in the <code>signalSorter</code> interface to pull up images and activity traces of nearby cells to see which have a higher SNR or better cell shape and should be kept.</li>
</ul>
<h2 id="neighboring-cells">Neighboring cells<a class="headerlink" href="#neighboring-cells" title="Permanent link">&para;</a></h2>
<ul>
<li>Sometimes two or more cell extraction outputs are for the same cell. In these suspected cases, press <code>t</code> in the <code>signalSorter</code> interface to pull up images and activity traces of nearby cells to see which have a higher SNR or better cell shape and should be kept.</li>
<li>See below for an example, in which cell #3 (yellow) is a duplicate of cell #1 (blue).</li>
</ul>
<p><img alt="image" src="https://user-images.githubusercontent.com/5241605/52926738-ea3bc600-32eb-11e9-9fa1-e05087f3c05a.png" /></p>
<h2 id="common-issues">Common issues<a class="headerlink" href="#common-issues" title="Permanent link">&para;</a></h2>
<ul>
<li>Cells with high SNR will sometimes be split into multiple cell extraction outputs. Refer to algorithm specific to notes on how to get around this problem.</li>
</ul>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<ul>
<li>Example of a good cell with GCaMP like rise/decay and for one-photon miniature microscope movies, has nice 2D Gaussian-like shape during transients in the movie.
<img src="https://user-images.githubusercontent.com/5241605/34796712-3868cb3a-f60b-11e7-830e-8eec5b2c76d7.gif" alt="drawing" width="600" height="auto"/>
<img src="https://user-images.githubusercontent.com/5241605/51698177-6a595f00-1fbe-11e9-9992-448881665c25.gif" alt="drawing" width="600" height="auto"/></li>
</ul>
<!-- ![2016_01_20_p460_m19_lineartrack01_s_good_cellmax_510_1_32](https://user-images.githubusercontent.com/5241605/51698177-6a595f00-1fbe-11e9-9992-448881665c25.gif) -->
<!-- ![out-1](https://user-images.githubusercontent.com/5241605/34796712-3868cb3a-f60b-11e7-830e-8eec5b2c76d7.gif) -->

<ul>
<li>Example of good cells on left and bad on right. Subplots: CELLMax output, mean movie frame centered on the cell and aligned to cell transients, and example CELLMax traces.
<img src="https://user-images.githubusercontent.com/5241605/35294233-e0ec1ca2-002a-11e8-837c-857c93a6c810.png" alt="drawing" width="600" height="auto"/></li>
</ul>
<!-- ![image](https://user-images.githubusercontent.com/5241605/35294233-e0ec1ca2-002a-11e8-837c-857c93a6c810.png) -->

<ul>
<li>Example of not-cells or borderline not-cells.
<img src="https://user-images.githubusercontent.com/5241605/51698178-6a595f00-1fbe-11e9-940f-5dbcb08d4018.gif" alt="drawing" width="600" height="auto"/>
<img src="https://user-images.githubusercontent.com/5241605/51698179-6a595f00-1fbe-11e9-9d4e-35ba75342cc4.gif" alt="drawing" width="600" height="auto"/></li>
</ul>
<!-- ![2016_01_20_p460_m19_lineartrack01_s_bad_cellmax_517_1_32](https://user-images.githubusercontent.com/5241605/51698178-6a595f00-1fbe-11e9-940f-5dbcb08d4018.gif) -->
<!-- ![2016_01_20_p460_m19_lineartrack01_s_bad_cellmax_511](https://user-images.githubusercontent.com/5241605/51698179-6a595f00-1fbe-11e9-9d4e-35ba75342cc4.gif) -->

<ul>
<li>Good cells with their matched movies aligned to algorithm (PCA-ICA in this case) detected transients.
<img src="https://cloud.githubusercontent.com/assets/5241605/26423683/67e85184-4083-11e7-88ff-f3bbe3600ffc.png" alt="drawing" width="600"/>
<img src="https://cloud.githubusercontent.com/assets/5241605/26423903/426a38b8-4084-11e7-93d5-f9962ea5b826.gif" alt="drawing" width="300"/>
<img src="https://cloud.githubusercontent.com/assets/5241605/26423927/52804e2c-4084-11e7-8184-f3ae240dedea.png" alt="drawing" width="600" height="auto"/>
<img src="https://cloud.githubusercontent.com/assets/5241605/26423979/7f5348fa-4084-11e7-8c62-a277ecbbd13a.gif" alt="drawing" width="300" height="auto"/></li>
</ul>
<!-- ![image](https://cloud.githubusercontent.com/assets/5241605/26423683/67e85184-4083-11e7-88ff-f3bbe3600ffc.png) -->
<!-- ![output3](https://cloud.githubusercontent.com/assets/5241605/26423903/426a38b8-4084-11e7-93d5-f9962ea5b826.gif) -->
<!-- ![image](https://cloud.githubusercontent.com/assets/5241605/26423927/52804e2c-4084-11e7-8184-f3ae240dedea.png) -->
<!-- ![output5](https://cloud.githubusercontent.com/assets/5241605/26423979/7f5348fa-4084-11e7-8c62-a277ecbbd13a.gif) -->

<ul>
<li>Additional examples of good cells.
<img src="https://cloud.githubusercontent.com/assets/5241605/10896133/e6c55e7a-816c-11e5-8527-f730ea0f7265.png" alt="drawing" width="600" height="auto"/>
<img src="https://cloud.githubusercontent.com/assets/5241605/11968975/bc4f24dc-a8c7-11e5-8b87-cf39eb52b62b.png" alt="drawing" width="600" height="auto"/></li>
</ul>
<!-- ![image](https://cloud.githubusercontent.com/assets/5241605/10896133/e6c55e7a-816c-11e5-8527-f730ea0f7265.png) -->
<!-- ![image](https://cloud.githubusercontent.com/assets/5241605/11968975/bc4f24dc-a8c7-11e5-8b87-cf39eb52b62b.png) -->

<ul>
<li>As noted, without the transient aligned movie (see above), cells with unusual traces might be discarded, e.g. all three below are actual cells when the movie is visualized.
<img src="https://cloud.githubusercontent.com/assets/5241605/11164758/4ea1c02a-8aae-11e5-90bf-b6314eebb53a.png" alt="drawing" width="600" height="auto"/></li>
</ul>
<!-- ![image](https://cloud.githubusercontent.com/assets/5241605/11164758/4ea1c02a-8aae-11e5-90bf-b6314eebb53a.png) -->
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../help_cross_session_alignment/" class="btn btn-neutral float-right" title="Cross-session alignemnt">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../help_cell_extraction/" class="btn btn-neutral" title="Cell extraction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../help_cell_extraction/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../help_cross_session_alignment/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
